{"mappings":"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","sources":["node_modules/@swc/helpers/lib/_class_extract_field_descriptor.js","node_modules/@swc/helpers/lib/_class_apply_descriptor_get.js","node_modules/@swc/helpers/lib/_check_private_redeclaration.js","node_modules/@swc/helpers/lib/_class_apply_descriptor_set.js","node_modules/@swc/helpers/lib/_class_private_field_get.js","node_modules/@swc/helpers/lib/_class_private_field_init.js","node_modules/@swc/helpers/lib/_class_private_field_set.js","node_modules/@swc/helpers/lib/_class_private_method_get.js","node_modules/@swc/helpers/lib/_class_private_method_init.js","src/js/library-api.js","src/js/library-service.js","src/js/film-card.js","src/js/library.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.default = _classExtractFieldDescriptor;\nfunction _classExtractFieldDescriptor(receiver, privateMap, action) {\n    if (!privateMap.has(receiver)) {\n        throw new TypeError(\"attempted to \" + action + \" private field on non-instance\");\n    }\n    return privateMap.get(receiver);\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.default = _classApplyDescriptorGet;\nfunction _classApplyDescriptorGet(receiver, descriptor) {\n    if (descriptor.get) {\n        return descriptor.get.call(receiver);\n    }\n    return descriptor.value;\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.default = _checkPrivateRedeclaration;\nfunction _checkPrivateRedeclaration(obj, privateCollection) {\n    if (privateCollection.has(obj)) {\n        throw new TypeError(\"Cannot initialize the same private elements twice on an object\");\n    }\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.default = _classApplyDescriptorSet;\nfunction _classApplyDescriptorSet(receiver, descriptor, value) {\n    if (descriptor.set) {\n        descriptor.set.call(receiver, value);\n    } else {\n        if (!descriptor.writable) {\n            // This should only throw in strict mode, but class bodies are\n            // always strict and private fields can only be used inside\n            // class bodies.\n            throw new TypeError(\"attempted to set read only private field\");\n        }\n        descriptor.value = value;\n    }\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.default = _classPrivateFieldGet;\nvar _classExtractFieldDescriptor = _interopRequireDefault(require(\"./_class_extract_field_descriptor\"));\nvar _classApplyDescriptorGet = _interopRequireDefault(require(\"./_class_apply_descriptor_get\"));\nfunction _classPrivateFieldGet(receiver, privateMap) {\n    var descriptor = (0, _classExtractFieldDescriptor).default(receiver, privateMap, \"get\");\n    return (0, _classApplyDescriptorGet).default(receiver, descriptor);\n}\nfunction _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n        default: obj\n    };\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.default = _classPrivateFieldInit;\nvar _checkPrivateRedeclaration = _interopRequireDefault(require(\"./_check_private_redeclaration\"));\nfunction _classPrivateFieldInit(obj, privateMap, value) {\n    (0, _checkPrivateRedeclaration).default(obj, privateMap);\n    privateMap.set(obj, value);\n}\nfunction _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n        default: obj\n    };\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.default = _classPrivateFieldSet;\nvar _classExtractFieldDescriptor = _interopRequireDefault(require(\"./_class_extract_field_descriptor\"));\nvar _classApplyDescriptorSet = _interopRequireDefault(require(\"./_class_apply_descriptor_set\"));\nfunction _classPrivateFieldSet(receiver, privateMap, value) {\n    var descriptor = (0, _classExtractFieldDescriptor).default(receiver, privateMap, \"set\");\n    (0, _classApplyDescriptorSet).default(receiver, descriptor, value);\n    return value;\n}\nfunction _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n        default: obj\n    };\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.default = _classPrivateMethodGet;\nfunction _classPrivateMethodGet(receiver, privateSet, fn) {\n    if (!privateSet.has(receiver)) {\n        throw new TypeError(\"attempted to get private field on non-instance\");\n    }\n    return fn;\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.default = _classPrivateMethodInit;\nvar _checkPrivateRedeclaration = _interopRequireDefault(require(\"./_check_private_redeclaration\"));\nfunction _classPrivateMethodInit(obj, privateSet) {\n    (0, _checkPrivateRedeclaration).default(obj, privateSet);\n    privateSet.add(obj);\n}\nfunction _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n        default: obj\n    };\n}\n","\nconst LOCALSTORAGE_KEY_PREFIX = 'MoviesLibrary_'; \n\nexport default class MoviesLibrary {\n\n  #LOCALSTORAGE_KEY;\n  #movies = [];\n\n  constructor(libName = 'mylib') {\n    this.#LOCALSTORAGE_KEY = LOCALSTORAGE_KEY_PREFIX + libName;\n    this.#loadMovies();\n  }\n\n  // -------  PRIVATE SECTION  -------\n  \n  #saveMovies() {\n    try {\n      localStorage.setItem(this.#LOCALSTORAGE_KEY, JSON.stringify(this.#movies));\n    } catch (err) {\n      console.error(`Error: failure saving movies in LocalStorage: ${this.#LOCALSTORAGE_KEY}`);\n    }\n  }\n\n  #loadMovies() {\n    this.#movies = [];\n    const jsonMovies = localStorage.getItem(this.#LOCALSTORAGE_KEY);\n    if (jsonMovies) {\n      try {\n        this.#movies = JSON.parse(jsonMovies);\n      } catch (err) {\n        console.error(`Error: invalid movies library in LocalStorage: ${this.#LOCALSTORAGE_KEY}`);\n      }\n    }\n  }\n\n  // -------  INTERFACE  -------\n  \n  getCount() {\n    return this.#movies.length;\n  }\n\n  getMovies() {\n    return this.#movies;\n  }\n\n  getMovieById(movieId) {\n    return this.#movies.find(el => el.id == movieId);\n  }\n\n  getCountPages(per_page) {\n    return Math.ceil(this.#movies.length / per_page);\n  }\n\n  getMoviesPage(page = 1, per_page = -1) {     // per_page == -1 - get all library, without pagination\n    if (per_page == -1) {\n      return this.#movies;\n    } else {\n      return this.#movies.slice((page - 1) * per_page, page * per_page);\n    }\n  }\n\n  refreshMovies() {\n    this.#loadMovies();\n  }\n\n  clearMovies() {\n    this.#movies = [];\n    this.#saveMovies();\n  }\n\n  addMovie(movie) {\n    const indexId = this.#movies.findIndex(el => el.id == movie.id);\n    if (indexId != -1) {\n      this.#movies[indexId] = movie;\n    } else {\n      this.#movies.push(movie);\n    }\n    this.#saveMovies();\n  }\n\n  removeMovie(movieId) {\n    const indexId = this.#movies.findIndex(el => el.id == movieId);\n    if (indexId != -1) {\n      this.#movies.splice(indexId, 1);\n      this.#saveMovies();\n    }\n  }\n}\n","import MoviesLibrary from './library-api';\n\nconst myLibs = {\n  watched: new MoviesLibrary('Watched_Test'),    // !?! - удалить _Test при деплое\n  queue:   new MoviesLibrary('Queue_Test')\n}\n\nexport default myLibs;\n\n\n// !?! Тестовое наполнение - удалить при деплое\n\nfor (const key of ['watched', 'queue']) {\n  const myLib = myLibs[key];\n  myLib.clearMovies();\n  for (let i = 0; i < 20; i += 1) {\n    myLib.addMovie({\n      id: String(i + 1),\n      title: `Avatar: The Way of Water (${key})`,\n      posterURL: (key == 'watched') ? 'https://image.tmdb.org/t/p/w500/t6HIqrRAclMCA60NsSmeqe9RmNV.jpg' :\n        'https://image.tmdb.org/t/p/w500/sfCmTkVVtwoW4yNu1Cs4ZDtCTa5.jpg',\n      genres: 'Drama, Comedy',\n      year: '2022',\n      vote: '5.7',\n      votes: '1234',\n      popularity: '100.2',\n      original: `Avatar: The Way of Water`,\n      overview: `Set more than a decade after the events of the first film, learn the story of the Sully family \n        (Jake, Neytiri, and their kids), the trouble that follows them, the lengths they go to keep each other safe,\n        the battles they fight to stay alive, and the tragedies they endure.`\n    });\n  }\n}\n// ------------------------------\n\n","export default\nfunction createFilmCardMarkup({id, posterURL = '', title = '', genres = 'no info', year = 'no info', votes = '' }) {\n  return ` \n    <div class=\"card\" data-filmid=\"${id}\">\n        <img src=\"${posterURL}\" class=\"card__pic\">\n        <div class=\"card__information\">\n            <p class=\"card__film-name\">${title}</p>\n            <div class=\"card__additional-information\">\n                <ul class=\"card__gener-list\">\n                    <li class=\"card__gener-item\">${genres}</li>\n                </ul>\n                <div class=\"card__vl\"></div>\n                <p class=\"card__release-year\">${year}</p>\n            </div>\n        </div>\n    </div>\n  `;\n}    \n","import myLibs from './library-service';\nimport createFilmCardMarkup from './film-card';\n\nlet myLib = myLibs.watched;\n\nlet page = 1;\nconst per_page = 6;   // !?! установить коррект\n\nconst refs = {\n  gallery:    document.querySelector('.gallery'),\n  btnWatched: document.querySelector('#btn-watched'),\n  btnQueue:   document.querySelector('#btn-queue'),\n};\n\nif (Object.values(refs).some(el => !el)) {\n  throw new Error('Invalid markup!');\n}\n\nrefs.gallery.insertAdjacentHTML('afterend', `<div class=\"js-guard\"></div>`); \nrefs.guardDiv = document.querySelector('.js-guard');\n\nrefs.btnWatched.addEventListener('click', onBtnLibraryClick);\nrefs.btnQueue.addEventListener('click', onBtnLibraryClick);\n\nfunction onBtnLibraryClick(evt) {\n  const curBtn = evt.currentTarget;\n  if (((curBtn == refs.btnWatched) && (myLib == myLibs.watched)) ||\n      ((curBtn == refs.btnQueue) && (myLib == myLibs.queue))) {\n    return;\n  }\n\n  page = 1;\n\n  if (curBtn == refs.btnWatched) {\n    myLib = myLibs.watched;\n    refs.btnWatched.classList.add('is-active');\n    refs.btnQueue.classList.remove('is-active');\n  } else if (curBtn == refs.btnQueue) {\n    myLib = myLibs.queue;\n    refs.btnWatched.classList.remove('is-active');\n    refs.btnQueue.classList.add('is-active');\n  }\n\n  myLib.refreshMovies();\n  showLibrary();\n}\n\nconst observerOpts = {\n  root: null,\n  rootMargin: '300px',\n  threshold: 1.0\n}\n\nconst onObserve = (entries, observer) => {\n  entries.forEach(entry => {\n    if (entry.isIntersecting) {\n      if (page < myLib.getCountPages(per_page)) {\n        page += 1;\n        showLibrary();  \n      }\n    }\n  });\n}\n\nconst observer = new IntersectionObserver(onObserve, observerOpts);\n\nfunction showLibrary() {\n\n  if ((page == 1) && (myLib.getCount() > 0)) {\n    refs.gallery.innerHTML = '';\n  }\n\n  const movies = myLib.getMoviesPage(page, per_page); \n\n  refs.gallery.insertAdjacentHTML('beforeend', createGalleryMarkup(movies));\n\n  if ((page == 1) && (myLib.getCountPages(per_page) > 1)) {\n    observer.observe(refs.guardDiv);\n  } else if (page == myLib.getCountPages(per_page)) {\n    observer.unobserve(refs.guardDiv);\n  }\n}\n\nfunction createGalleryMarkup(movies) {\n  return movies.map(movie => createFilmCardMarkup(movie)).join('');\n}\n\nshowLibrary();\n\n// ---------  LIBRARY IN MODAL  -----------\n\nconst refsM = {\n  btnWatched: document.querySelector('.modal__button--watched'),\n  btnQueue:   document.querySelector('.modal__button--queue'),\n  infoId:     document.querySelector('.modal__information'),\n  title:      document.querySelector('.modal__title'),\n  poster:     document.querySelector('.modal__image'),\n  overview:   document.querySelector('.modal__text'),\n};\n\nif (Object.values(refsM).some(el => !el)) {\n  throw new Error('Invalid markup of modal window!');\n}\n\nrefsM.btnWatched.addEventListener('click', onModalLibraryClick.bind(null, \"watched\"));\nrefsM.btnQueue.addEventListener('click', onModalLibraryClick.bind(null, \"queue\"));\n\nfunction getModalFilmId() {\n  return refsM.infoId.dataset.filmid;\n}\n\nfunction onModalLibraryClick(libName) {\n  const movieId = getModalFilmId();\n\n  if (!movieId) {\n    return;\n  }\n\n  if (myLibs[libName].getMovieById(movieId)) {\n    myLibs[libName].removeMovie(movieId);\n  } else {\n    const movie = getMovieModal();\n    myLibs[libName].addMovie(movie);\n  }\n  refreshBtns();\n}\n\nfunction refreshBtns() {\n  const movieId = getModalFilmId();\n\n  if (!movieId) {\n    return;\n  }\n\n  if (myLibs.watched.getMovieById(movieId)) {\n    refsM.btnWatched.textContent = 'REMOVE FROM WATCHED';\n    refsM.btnWatched.classList.remove(\"active\");\n  } else {\n    refsM.btnWatched.textContent = 'ADD TO WATCHED';\n    refsM.btnWatched.classList.add(\"active\");\n  }\n\n  if (myLibs.queue.getMovieById(movieId)) {\n    refsM.btnQueue.textContent = 'REMOVE FROM QUEUE';\n    refsM.btnQueue.classList.remove(\"active\");\n  } else {\n    refsM.btnQueue.textContent = 'ADD TO QUEUE';\n    refsM.btnQueue.classList.add(\"active\");\n  }\n}\n\nfunction getMovieModal() {\n  const movie = {\n    id: movieId,\n    title: refsM.title.textContent,\n    posterURL: refsM.poster.src,\n    overview: refsM.overview.textContent,\n    /* !?! - доделать когда будет разметка\n    genres: 'Drama, Comedy',\n    year: 2022,\n    vote: '5.7',\n    votes: '1234',\n    popularity: '100.2',\n    original: `Avatar: The Way of Water`,\n    */\n  };\n\n  return movie;\n}\n"],"names":["Object","defineProperty","module","exports","value","default","receiver","privateMap","action","has","TypeError","get","descriptor","call","obj","privateCollection","set","writable","$37616d1d2d9e1de3$exports","$37616d1d2d9e1de3$var$_classExtractFieldDescriptor","$37616d1d2d9e1de3$var$_classApplyDescriptorGet","$37616d1d2d9e1de3$var$_interopRequireDefault","parcelRequire","__esModule","$665bb80dc57e205a$exports","$665bb80dc57e205a$var$_checkPrivateRedeclaration","$a11a0d8e92c06afc$exports","$a11a0d8e92c06afc$var$_classExtractFieldDescriptor","$a11a0d8e92c06afc$var$_classApplyDescriptorSet","$a11a0d8e92c06afc$var$_interopRequireDefault","$82ce8d6f4ce6ea51$exports","privateSet","fn","$b5362597a15e80da$exports","$b5362597a15e80da$var$_checkPrivateRedeclaration","add","$b5362597a15e80da$var$_interopRequireDefault","$8a642d0319cc4e27$var$_LOCALSTORAGE_KEY","WeakMap","$8a642d0319cc4e27$var$_movies","$8a642d0319cc4e27$var$_saveMovies","WeakSet","$8a642d0319cc4e27$var$_loadMovies","$8a642d0319cc4e27$export$2e2bcd8739ae039","getCount","$parcel$interopDefault","this","length","getMovies","getMovieById","movieId","find","el","id","getCountPages","per_page","Math","ceil","getMoviesPage","page","slice","refreshMovies","$8a642d0319cc4e27$var$loadMovies","clearMovies","$8a642d0319cc4e27$var$saveMovies","addMovie","movie","indexId","findIndex","push","removeMovie","splice","constructor","libName","localStorage","setItem","JSON","stringify","err","console","error","jsonMovies","getItem","parse","$3b281428ac20a3a5$var$myLibs","watched","queue","$3b281428ac20a3a5$export$2e2bcd8739ae039","key","myLib","i","String","title","posterURL","genres","year","vote","votes","popularity","original","overview","$80c4189e6cc88ea4$export$2e2bcd8739ae039","$93effc6fc56091ad$var$myLib","$93effc6fc56091ad$var$page","$93effc6fc56091ad$var$refs","gallery","document","querySelector","btnWatched","btnQueue","values","some","Error","$93effc6fc56091ad$var$onBtnLibraryClick","evt","curBtn","currentTarget","classList","remove","$93effc6fc56091ad$var$showLibrary","insertAdjacentHTML","guardDiv","addEventListener","$93effc6fc56091ad$var$observer","IntersectionObserver","entries","observer","forEach","entry","isIntersecting","root","rootMargin","threshold","innerHTML","movies","map","join","$93effc6fc56091ad$var$createGalleryMarkup","observe","unobserve","$93effc6fc56091ad$var$refsM","infoId","poster","$93effc6fc56091ad$var$getModalFilmId","dataset","filmid","$93effc6fc56091ad$var$onModalLibraryClick","$93effc6fc56091ad$var$getMovieModal","textContent","$93effc6fc56091ad$var$refreshBtns","src","bind"],"version":3,"file":"library.84d9a48e.js.map"}