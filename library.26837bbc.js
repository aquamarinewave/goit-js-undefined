function e(e){return e&&e.__esModule?e.default:e}var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},n={},r={},i=t.parcelRequired7c6;null==i&&((i=function(e){if(e in n)return n[e].exports;if(e in r){var t=r[e];delete r[e];var i={id:e,exports:{}};return n[e]=i,t.call(i.exports,i,i.exports),i.exports}var o=new Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}).register=function(e,t){r[e]=t},t.parcelRequired7c6=i),i.register("fExtF",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}})),i.register("iaRLo",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(e,t){return t.get?t.get.call(e):t.value}})),i.register("7K24o",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}})),i.register("3LGG3",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}}));var o={};Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(e,t){var n=a.default(e,t,"get");return s.default(e,n)};var a=l(i("fExtF")),s=l(i("iaRLo"));function l(e){return e&&e.__esModule?e:{default:e}}var d={};Object.defineProperty(d,"__esModule",{value:!0}),d.default=function(e,t,n){c.default(e,t),t.set(e,n)};var u,c=(u=i("7K24o"))&&u.__esModule?u:{default:u};var f={};Object.defineProperty(f,"__esModule",{value:!0}),f.default=function(e,t,n){var r=v.default(e,t,"set");return h.default(e,r,n),n};var v=g(i("fExtF")),h=g(i("3LGG3"));function g(e){return e&&e.__esModule?e:{default:e}}var p={};Object.defineProperty(p,"__esModule",{value:!0}),p.default=function(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n};var m={};Object.defineProperty(m,"__esModule",{value:!0}),m.default=function(e,t){_.default(e,t),t.add(e)};var _=function(e){return e&&e.__esModule?e:{default:e}}(i("7K24o"));var b=new WeakMap,y=new WeakMap,w=new WeakSet,M=new WeakSet;class E{getCount(){return e(o)(this,y).length}getMovies(){return e(o)(this,y)}getMovieById(t){return e(o)(this,y).find((e=>e.id==t))}getCountPages(t){return Math.ceil(e(o)(this,y).length/t)}getMoviesPage(t=1,n=-1){return-1==n?e(o)(this,y):e(o)(this,y).slice((t-1)*n,t*n)}refreshMovies(){e(p)(this,M,L).call(this)}clearMovies(){e(f)(this,y,[]),e(p)(this,w,x).call(this)}addMovie(t){const n=e(o)(this,y).findIndex((e=>e.id==t.id));-1!=n?e(o)(this,y)[n]=t:e(o)(this,y).push(t),e(p)(this,w,x).call(this)}removeMovie(t){const n=e(o)(this,y).findIndex((e=>e.id==t));-1!=n&&(e(o)(this,y).splice(n,1),e(p)(this,w,x).call(this))}constructor(t="mylib"){e(m)(this,w),e(m)(this,M),e(d)(this,b,{writable:!0,value:void 0}),e(d)(this,y,{writable:!0,value:[]}),e(f)(this,b,"MoviesLibrary_"+t),e(p)(this,M,L).call(this)}}function x(){try{localStorage.setItem(e(o)(this,b),JSON.stringify(e(o)(this,y)))}catch(t){console.error(`Error: failure saving movies in LocalStorage: ${e(o)(this,b)}`)}}function L(){e(f)(this,y,[]);const t=localStorage.getItem(e(o)(this,b));if(t)try{e(f)(this,y,JSON.parse(t))}catch(t){console.error(`Error: invalid movies library in LocalStorage: ${e(o)(this,b)}`)}}const W={watched:new E("Watched_Test"),queue:new E("Queue_Test")};var O=W;for(const e of["watched","queue"]){const t=W[e];t.clearMovies();for(let n=0;n<20;n+=1)t.addMovie({id:String(n+1),title:`Avatar: The Way of Water (${e})`,posterURL:"watched"==e?"https://image.tmdb.org/t/p/w500/t6HIqrRAclMCA60NsSmeqe9RmNV.jpg":"https://image.tmdb.org/t/p/w500/sfCmTkVVtwoW4yNu1Cs4ZDtCTa5.jpg",genres:"Drama, Comedy",year:"2022",vote:"5.7",votes:"1234",popularity:"100.2",original:"Avatar: The Way of Water",overview:"Set more than a decade after the events of the first film, learn the story of the Sully family \n        (Jake, Neytiri, and their kids), the trouble that follows them, the lengths they go to keep each other safe,\n        the battles they fight to stay alive, and the tragedies they endure."})}function q({id:e,posterURL:t="",title:n="",genres:r="no info",year:i="no info",votes:o=""}){return` \n    <div class="card" data-filmid="${e}">\n        <img src="${t}" class="card__pic">\n        <div class="card__information">\n            <p class="card__film-name">${n}</p>\n            <div class="card__additional-information">\n                <ul class="card__gener-list">\n                    <li class="card__gener-item">${r}</li>\n                </ul>\n                <div class="card__vl"></div>\n                <p class="card__release-year">${i}</p>\n            </div>\n        </div>\n    </div>\n  `}let S=O.watched,C=1;const T={gallery:document.querySelector(".gallery"),btnWatched:document.querySelector("#btn-watched"),btnQueue:document.querySelector("#btn-queue")};if(Object.values(T).some((e=>!e)))throw new Error("Invalid markup!");function j(e){const t=e.currentTarget;t==T.btnWatched&&S==O.watched||t==T.btnQueue&&S==O.queue||(C=1,t==T.btnWatched?(S=O.watched,T.btnWatched.classList.add("is-active"),T.btnQueue.classList.remove("is-active")):t==T.btnQueue&&(S=O.queue,T.btnWatched.classList.remove("is-active"),T.btnQueue.classList.add("is-active")),S.refreshMovies(),P())}T.gallery.insertAdjacentHTML("afterend",'<div class="js-guard"></div>'),T.guardDiv=document.querySelector(".js-guard"),T.btnWatched.addEventListener("click",j),T.btnQueue.addEventListener("click",j);const I=new IntersectionObserver(((e,t)=>{e.forEach((e=>{e.isIntersecting&&C<S.getCountPages(6)&&(C+=1,P())}))}),{root:null,rootMargin:"300px",threshold:1});function P(){1==C&&S.getCount()>0&&(T.gallery.innerHTML="");const e=S.getMoviesPage(C,6);T.gallery.insertAdjacentHTML("beforeend",function(e){return e.map((e=>q(e))).join("")}(e)),1==C&&S.getCountPages(6)>1?I.observe(T.guardDiv):C==S.getCountPages(6)&&I.unobserve(T.guardDiv)}P();const Q={btnWatched:document.querySelector(".modal__button--watched"),btnQueue:document.querySelector(".modal__button--queue"),infoId:document.querySelector(".modal__information"),title:document.querySelector(".modal__title"),poster:document.querySelector(".modal__image"),overview:document.querySelector(".modal__text")};if(Object.values(Q).some((e=>!e)))throw new Error("Invalid markup of modal window!");function k(){return Q.infoId.dataset.filmid}function D(e){const t=k();if(t){if(O[e].getMovieById(t))O[e].removeMovie(t);else{const t=R();O[e].addMovie(t)}!function(){const e=k();if(!e)return;O.watched.getMovieById(e)?(Q.btnWatched.textContent="REMOVE FROM WATCHED",Q.btnWatched.classList.remove("active")):(Q.btnWatched.textContent="ADD TO WATCHED",Q.btnWatched.classList.add("active"));O.queue.getMovieById(e)?(Q.btnQueue.textContent="REMOVE FROM QUEUE",Q.btnQueue.classList.remove("active")):(Q.btnQueue.textContent="ADD TO QUEUE",Q.btnQueue.classList.add("active"))}()}}function R(){return{id:movieId,title:Q.title.textContent,posterURL:Q.poster.src,overview:Q.overview.textContent}}Q.btnWatched.addEventListener("click",D.bind(null,"watched")),Q.btnQueue.addEventListener("click",D.bind(null,"queue"));
//# sourceMappingURL=library.26837bbc.js.map
