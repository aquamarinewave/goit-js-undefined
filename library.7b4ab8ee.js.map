{"mappings":"gfAAA,IAAAA,EAAAC,EAAA,SCCA,SAAAC,GAA8BC,GAACA,EAAEC,UAAEA,EAAY,GAAEC,MAAEA,EAAQ,GAAEC,OAAEA,EAAS,UAASC,KAAEA,EAAO,UAASC,MAAEA,EAAQ,KAC3G,MAAO,yCAC4BL,0BACjBC,0GAEqBC,kKAGUC,8HAGHC,2D,CDThD,IAAIE,EAAQT,EAAAU,QAAOC,QAEfC,EAAO,EACX,MAEMC,EAAO,CACXC,QAASC,SAASC,cAAc,aAGlC,GAAIC,OAAOC,OAAOL,GAAMM,MAAKC,IAAOA,IAClC,MAAM,IAAIC,MAAM,mBAmBlB,SAASC,EAAkBC,GACzB,MAAMC,EAASD,EAAIE,cACfD,GAAYX,EAAKa,YAAgBjB,GAAST,EAAAU,QAAOC,SAChDa,GAAWX,EAAKc,UAAclB,GAAST,EAAAU,QAAOkB,QAInDhB,EAAO,EAEHY,GAAUX,EAAKa,YACjBjB,EAAQT,EAAAU,QAAOC,QACfE,EAAKa,WAAWG,UAAUC,IAAI,aAC9BjB,EAAKc,SAASE,UAAUE,OAAO,cACtBP,GAAUX,EAAKc,WACxBlB,EAAQT,EAAAU,QAAOkB,MACff,EAAKa,WAAWG,UAAUE,OAAO,aACjClB,EAAKc,SAASE,UAAUC,IAAI,cAG9BrB,EAAMuB,gBACNC,I,CApCFpB,EAAKC,QAAQoB,mBAAmB,WAAY,gCAC5CrB,EAAKsB,SAAWpB,SAASC,cAAc,aAIvCH,EAAKC,QAAQoB,mBAAmB,cAAe,yFAC/CrB,EAAKC,QAAQoB,mBAAmB,cAAe,2EAE/CrB,EAAKa,WAAaX,SAASC,cAAc,gBACzCH,EAAKc,SAAWZ,SAASC,cAAc,cAIvCH,EAAKa,WAAWU,iBAAiB,QAASd,GAC1CT,EAAKc,SAASS,iBAAiB,QAASd,GAyBxC,MAiBMe,EAAW,IAAIC,sBAXH,CAACC,EAASC,KAC1BD,EAAQE,SAAQC,IACVA,EAAMC,gBACJ/B,EAAOH,EAAMmC,cA1DN,KA2DThC,GAAQ,EACRqB,I,GAGJ,GAdiB,CACnBY,KAAM,KACNC,WAAY,QACZC,UAAW,IAgBb,SAASd,IAEM,GAATrB,GAAgBH,EAAMuC,WAAa,IACrCnC,EAAKC,QAAQmC,UAAY,IAG3B,MAAMC,EAASzC,EAAM0C,cAAcvC,EA1EpB,GA4EfC,EAAKC,QAAQoB,mBAAmB,YASlC,SAA6BgB,GAC3B,OAAOA,EAAOE,KAAIC,GAASnD,EAAqBmD,KAAQC,KAAK,G,CAVhBC,CAAoBL,IAEpD,GAATtC,GAAgBH,EAAMmC,cA9EX,GA8EqC,EAClDP,EAASmB,QAAQ3C,EAAKsB,UACbvB,GAAQH,EAAMmC,cAhFV,IAiFbP,EAASoB,UAAU5C,EAAKsB,S,CAQ5BF,G","sources":["src/js/library.js","src/js/film-card.js"],"sourcesContent":["import myLibs from './library-service';\nimport createFilmCardMarkup from './film-card';\n\nlet myLib = myLibs.watched;\n\nlet page = 1;\nconst per_page = 6;   // !?! установить коррект\n\nconst refs = {\n  gallery: document.querySelector('.gallery'),\n};\n\nif (Object.values(refs).some(el => !el)) {\n  throw new Error('Invalid markup!');\n}\n\nrefs.gallery.insertAdjacentHTML('afterend', `<div class=\"js-guard\"></div>`); \nrefs.guardDiv = document.querySelector('.js-guard');\n\n// !?! Тестовая разметка - удалить при деплое, заменить на реал\n\nrefs.gallery.insertAdjacentHTML('beforebegin', `<button type=\"button\" id=\"btn-watched\" class=\"btn-library is-active\">Watched</button>`); \nrefs.gallery.insertAdjacentHTML('beforebegin', `<button type=\"button\" id=\"btn-queue\" class=\"btn-library\">Queue</button>`); \n\nrefs.btnWatched = document.querySelector('#btn-watched');\nrefs.btnQueue = document.querySelector('#btn-queue');\n\n// -----------------------------------\n\nrefs.btnWatched.addEventListener('click', onBtnLibraryClick);\nrefs.btnQueue.addEventListener('click', onBtnLibraryClick);\n\nfunction onBtnLibraryClick(evt) {\n  const curBtn = evt.currentTarget;\n  if (((curBtn == refs.btnWatched) && (myLib == myLibs.watched)) ||\n      ((curBtn == refs.btnQueue) && (myLib == myLibs.queue))) {\n    return;\n  }\n\n  page = 1;\n\n  if (curBtn == refs.btnWatched) {\n    myLib = myLibs.watched;\n    refs.btnWatched.classList.add('is-active');\n    refs.btnQueue.classList.remove('is-active');\n  } else if (curBtn == refs.btnQueue) {\n    myLib = myLibs.queue;\n    refs.btnWatched.classList.remove('is-active');\n    refs.btnQueue.classList.add('is-active');\n  }\n\n  myLib.refreshMovies();\n  showLibrary();\n}\n\nconst observerOpts = {\n  root: null,\n  rootMargin: '300px',\n  threshold: 1.0\n}\n\nconst onObserve = (entries, observer) => {\n  entries.forEach(entry => {\n    if (entry.isIntersecting) {\n      if (page < myLib.getCountPages(per_page)) {\n        page += 1;\n        showLibrary();  \n      }\n    }\n  });\n}\n\nconst observer = new IntersectionObserver(onObserve, observerOpts);\n\nfunction showLibrary() {\n\n  if ((page == 1) && (myLib.getCount() > 0)) {\n    refs.gallery.innerHTML = '';\n  }\n\n  const movies = myLib.getMoviesPage(page, per_page); \n\n  refs.gallery.insertAdjacentHTML('beforeend', createGalleryMarkup(movies));\n\n  if ((page == 1) && (myLib.getCountPages(per_page) > 1)) {\n    observer.observe(refs.guardDiv);\n  } else if (page == myLib.getCountPages(per_page)) {\n    observer.unobserve(refs.guardDiv);\n  }\n}\n\nfunction createGalleryMarkup(movies) {\n  return movies.map(movie => createFilmCardMarkup(movie)).join('');\n}\n\nshowLibrary();\n","export default\nfunction createFilmCardMarkup({id, posterURL = '', title = '', genres = 'no info', year = 'no info', votes = '' }) {\n  return ` \n    <div class=\"card\" data-filmid=\"${id}\">\n        <img src=\"${posterURL}\" class=\"card__pic\">\n        <div class=\"card__information\">\n            <p class=\"card__film-name\">${title}</p>\n            <div class=\"card__additional-information\">\n                <ul class=\"card__gener-list\">\n                    <li class=\"card__gener-item\">${genres}</li>\n                </ul>\n                <div class=\"card__vl\"></div>\n                <p class=\"card__release-year\">${year}</p>\n            </div>\n        </div>\n    </div>\n  `;\n}    \n"],"names":["$54T7b","parcelRequire","$80c4189e6cc88ea4$export$2e2bcd8739ae039","id","posterURL","title","genres","year","votes","$93effc6fc56091ad$var$myLib","default","watched","$93effc6fc56091ad$var$page","$93effc6fc56091ad$var$refs","gallery","document","querySelector","Object","values","some","el","Error","$93effc6fc56091ad$var$onBtnLibraryClick","evt","curBtn","currentTarget","btnWatched","btnQueue","queue","classList","add","remove","refreshMovies","$93effc6fc56091ad$var$showLibrary","insertAdjacentHTML","guardDiv","addEventListener","$93effc6fc56091ad$var$observer","IntersectionObserver","entries","observer","forEach","entry","isIntersecting","getCountPages","root","rootMargin","threshold","getCount","innerHTML","movies","getMoviesPage","map","movie","join","$93effc6fc56091ad$var$createGalleryMarkup","observe","unobserve"],"version":3,"file":"library.7b4ab8ee.js.map"}